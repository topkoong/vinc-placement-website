---
// Root index page that detects browser language and redirects
// This ensures users see the site in their preferred language automatically
---

<!doctype html>
<html lang='ja'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>VINC Placement - Redirecting...</title>
    <style>
      /* Loading screen styles */
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      .loader {
        text-align: center;
        color: white;
      }
      .spinner {
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-top: 4px solid white;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class='loader'>
      <div class='spinner'></div>
      <p>リダイレクト中... / Redirecting... / กำลังเปลี่ยนเส้นทาง...</p>
    </div>

    <script>
      // Language detection and redirect logic
      (function () {
        // Get browser language
        const browserLang = navigator.language || navigator.userLanguage;
        const langCode = browserLang.split('-')[0].toLowerCase();

        // Supported languages
        const supportedLangs = ['en', 'ja', 'th'];

        // Always default to Japanese unless specifically Thai
        // This ensures Japanese is the primary language for the site
        let targetLang = 'ja'; // Default to Japanese

        // Only redirect to Thai if browser is explicitly set to Thai
        if (langCode === 'th') {
          targetLang = 'th';
        }
        // Only redirect to English if browser is explicitly set to English AND user hasn't visited before
        else if (langCode === 'en') {
          // Check if user has a language preference stored
          const savedLang = localStorage.getItem('preferred-language');
          if (savedLang && supportedLangs.includes(savedLang)) {
            targetLang = savedLang;
          } else {
            // For first-time English users, still default to Japanese
            targetLang = 'ja';
          }
        }

        // Redirect to appropriate language version
        window.location.href = `/${targetLang}/`;
      })();
    </script>
  </body>
</html>
