---
// Dark mode toggle component using vanilla JavaScript
interface Props {
  className?: string;
}

const { className = '' } = Astro.props;
---

<div class={`theme-toggle ${className}`}>
  <button
    id='theme-toggle'
    class='relative w-12 h-6 bg-gray-300 dark:bg-gray-600 rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500'
    aria-label='Toggle dark mode'
  >
    <div
      id='theme-toggle-slider'
      class='absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transition-transform duration-300 ease-in-out'
    >
      <svg
        id='theme-icon'
        class='w-5 h-5 text-yellow-500'
        fill='currentColor'
        viewBox='0 0 20 20'
      >
        <path
          fill-rule='evenodd'
          d='M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z'
          clip-rule='evenodd'></path>
      </svg>
    </div>
  </button>
</div>

<script>
  // Theme toggle functionality with smooth animations
  document.addEventListener('DOMContentLoaded', function () {
    const themeToggle = document.getElementById('theme-toggle');
    const themeSlider = document.getElementById('theme-toggle-slider');
    const themeIcon = document.getElementById('theme-icon');

    if (themeToggle && themeSlider && themeIcon) {
      // Initialize theme on page load
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia(
        '(prefers-color-scheme: dark)'
      ).matches;

      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        document.documentElement.classList.add('dark');
        themeSlider.style.transform = 'translateX(24px)';
        themeIcon.innerHTML =
          '<path fill-rule="evenodd" d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" clip-rule="evenodd" />';
      }

      themeToggle.addEventListener('click', function () {
        const isDark = document.documentElement.classList.contains('dark');

        // Smooth slider animation
        themeSlider.style.transform = isDark
          ? 'translateX(0px)'
          : 'translateX(24px)';

        // Toggle theme
        if (isDark) {
          document.documentElement.classList.remove('dark');
          localStorage.setItem('theme', 'light');
          // Sun icon
          themeIcon.innerHTML =
            '<path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />';
        } else {
          document.documentElement.classList.add('dark');
          localStorage.setItem('theme', 'dark');
          // Moon icon
          themeIcon.innerHTML =
            '<path fill-rule="evenodd" d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" clip-rule="evenodd" />';
        }
      });
    }
  });
</script>

<style>
  .theme-toggle button:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
  }

  #theme-toggle-slider {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
</style>
